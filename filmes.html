<!---------------------------------->
<script src="usuarios.js"></script>
<script src="api.js"></script>
<!---------------------------------->


<script>
  if (!estaLogado()) {
    redirecionar('index.html')
  }



  const meuPlano = obterMeuPlano()


</script>

<!doctype html>
<html lang="pt-BR">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Catálogo de Filmes — Apenas Capas</title>
  <style>
    :root {
      --bg: #0b0b0d;
      --card: #0f1720;
      --muted: #9aa4b2;
      --accent: #ff3b6b;
      --gap: 14px;
    }

    * {
      box-sizing: border-box
    }

    html,
    body {
      height: 100%
    }

    body {
      margin: 0;
      font-family: Inter, Roboto, system-ui, -apple-system, "Segoe UI", "Helvetica Neue", Arial;
      background: #2b2b2b;
      color: #e6eef6;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      padding: 28px;


      background: url('img/bg.jpg') no-repeat center center fixed;
            background-size: cover;
    }

    .wrap {
      max-width: 1200px;
      margin: 0 auto;
    }

    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 18px;
    }

    header h1 {
      font-size: 18px;
      letter-spacing: 1px;
      margin: 0;
      color: var(--muted);
      font-weight: 600;
    }

    /* Grid of posters */
    .gallery {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
      gap: var(--gap);
    }

    /* Each poster card keeps the poster aspect ratio (2:3) */
    .poster {
      position: relative;
      width: 100%;
      aspect-ratio: 2 / 3;
      overflow: hidden;
      border-radius: 10px;
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.02), rgba(0, 0, 0, 0.12));
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.6), inset 0 1px 0 rgba(255, 255, 255, 0.02);
      transition: transform .28s cubic-bezier(.2, .9, .2, 1), box-shadow .28s;
      transform-origin: center;
      cursor: pointer;
      border: 1px solid rgba(255, 255, 255, 0.03);
    }

    .poster:focus {
      outline: 2px solid rgba(255, 255, 255, 0.06);
    }

    .poster img {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      transform-origin: center;
      transition: transform .4s ease;
    }

    .poster:hover,
    .poster:focus {
      transform: translateY(-6px) scale(1.03);
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.7), 0 6px 22px rgba(0, 0, 0, 0.5);
    }

    .poster:hover img {
      transform: scale(1.06) rotate(-0.3deg)
    }

    /* optional faint label shown only on focus (accessibility) */
    .label {
      position: absolute;
      left: 8px;
      right: 8px;
      bottom: 8px;
      font-size: 12px;
      color: var(--muted);
      background: linear-gradient(180deg, rgba(0, 0, 0, 0.25), rgba(0, 0, 0, 0.5));
      padding: 6px 8px;
      border-radius: 7px;
      display: none;
      /* hide by default; comment out if you want visible titles */
      pointer-events: none;
    }

    .poster:focus .label {
      display: block
    }

    /* responsive tweaks */
    @media (min-width:600px) {
      .gallery {
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      }
    }

    @media (min-width:900px) {
      .gallery {
        grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      }
    }

    @media (min-width:1200px) {
      .gallery {
        grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      }
    }

    /* Empty state */
    .empty {
      text-align: center;
      padding: 48px 12px;
      color: var(--muted);
    }

    /* small utility */
    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0
    }













    .player_filme {
      display: none;
      width: 100%;
      height: 100%;
      background-color: rgb(0, 0, 0);
      position: fixed;
      left: 0;
      top: 0;
      z-index: 1000000;
    }

    video {
      width: 100%;
      height: 100vh;
    }

    .fechar {
      cursor: pointer;
      background-color: rgb(21, 21, 21);
      padding: 5px;
      border-radius: 150%;
      position: fixed;
      right: 5%;
      top: 5%;
      color: rgb(194, 77, 77);
      font-size: x-large;
      font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif
    }

    .buscar {
      font-size: 23px;
      width: 50%;
      background-color: #414141;
      color: #ff0000;
      border: none;
    }
  </style>
</head>

<body>

  <div class="player_filme" id="player_filme">
    <video id="video" controls src=""></video>
    <div class="fechar" id="fechar">
      X
    </div>
  </div>



  <div class="wrap">
    <header>

      <div aria-hidden="true" id="Perfil"
        style="border-radius:5px;padding:5px;color:rgb(241, 225, 225);background-color:rgb(169, 75, 75);font-size:23px">
        Perfil</div>
      <input class="buscar" id="buscar" type="text" placeholder="Buscar filme...">
    </header>

    <main>


      <section id="gallery" class="gallery" aria-live="polite">
        <!-- Posters serão injetados aqui pelo JavaScript -->
      </section>

      <div id="empty" class="empty" style="display:none">
        Nenhuma capa disponível.
      </div>
    </main>
  </div>
  <br>
  <br>
  <br>
  <script src="filmes.js"></script>
  <script>


    if (meuPlano == 'basico') {
      get('buscar').remove()
      //remover download
    }
    if (meuPlano == 'premium') {
      //remover download
    }
    if (meuPlano == 'master') {

    }
    //-----------------

    const gallery = document.getElementById('gallery');
    const empty = document.getElementById('empty');




    function renderPosters(list) {
      var ct = 0;
      gallery.innerHTML = '';
      if (!list || list.length === 0) {
        empty.style.display = 'block';
        return;
      }
      empty.style.display = 'none';

      list.forEach(() => {

        if (!posters[ct]) {
          return
        }
        if ('' == posters[ct + 1]) {
          //console.log(posters[ct])//ver filmes faltando

        }


        else {

          const a = document.createElement('a');
          //a.href = "player.html?filme="+posters[ct + 1];
          //a.target = '_blank';
          a.className = 'poster';
          //a.setAttribute('aria-label', 'Capa do filme ' + (idx + 1));
          a.setAttribute('role', 'img');

          const img = document.createElement('img');
          img.src = 'capas/' + posters[ct];


          a.appendChild(img);
          gallery.appendChild(a);

          var filme_link = posters[ct + 1]

          a.addEventListener('click', () => {
            document.getElementById('player_filme').style.display = 'block'
            console.clear()
            console.log(filme_link)
            document.getElementById('video').src = filme_link;
            document.getElementById('video').play()
          })
        }
        ct += 2

      });
    }

    renderPosters(posters);




    if (document.getElementById('buscar')) {
      document.getElementById('buscar').addEventListener('input', () => {

        var ct = 0
        gallery.innerHTML = '';



        posters.forEach(() => {

          if (posters[ct]) {
            if (posters[ct + 1] !== '') {




              if (posters[ct].toLowerCase().includes(document.getElementById('buscar').value.toLowerCase())) {

                const a = document.createElement('a');
                //a.href = "player.html?filme="+posters[ct + 1];
                //a.target = '_blank';
                a.className = 'poster';
                //a.setAttribute('aria-label', 'Capa do filme ' + (idx + 1));
                a.setAttribute('role', 'img');

                const img = document.createElement('img');
                img.src = 'capas/' + posters[ct];


                a.appendChild(img);
                gallery.appendChild(a);

                var filme_link = posters[ct + 1]

                a.addEventListener('click', () => {
                  document.getElementById('player_filme').style.display = 'block'
                  console.clear()
                  console.log(filme_link)
                  document.getElementById('video').src = filme_link;
                })

              }

            }
          }
          ct += 2

        });
      })
    }




    setInterval(() => {
      document.getElementById('player_filme').style.height = '100vh'
      document.getElementById('player_filme').style.width = '100vw'
    }, 1);




    addClick('fechar', () => {
      document.getElementById('video').src = '';
      document.getElementById('player_filme').style.display = 'none'
    })

    addClick('Perfil', () => {
      redirecionar('perfil.html')
    })

  </script>
</body>

</html>