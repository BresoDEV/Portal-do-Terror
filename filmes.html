<!---------------------------------->
<script src="usuarios.js"></script>
<script src="api.js"></script>
<!---------------------------------->
<script>
  if (!estaLogado()) {
    redirecionar('index.html')
  }



  const meuPlano = obterMeuPlano()
</script>
<!doctype html>
<html lang="pt-BR">
    <link href="https://vjs.zencdn.net/8.10.0/video-js.css" rel="stylesheet">
    <script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>V1</title>
        <style>


.vjs-red-theme .vjs-control-bar,
.vjs-red-theme .vjs-big-play-button {
  background-color: rgb(124, 38, 38) !important;
  border-color: rgb(107, 21, 21) !important;
}
.vjs-red-theme .vjs-progress-holder .vjs-play-progress {
  background-color: rgb(130, 30, 30) !important;
}
    
    :root {
      --bg: #0b0b0d;
      --card: #0f1720;
      --muted: #9aa4b2;
      --accent: #ff3b6b;
      --gap: 14px;
    }

    * {
      -webkit-tap-highlight-color: transparent;
            /* Remove o flash azul no toque */
            -webkit-touch-callout: none;
            /* Remove menu de toque (iOS) */
            user-select: none;
            /* Impede seleção de texto acidental (opcional) */
            -webkit-user-select: none;
            /* Compatibilidade com WebKit */
            
      box-sizing: border-box
    }

    html,
    body {
      height: 100%
    }

    body {
      margin: 0;
      font-family: Inter, Roboto, system-ui, -apple-system, "Segoe UI", "Helvetica Neue", Arial;
      background: #2b2b2b;
      color: #e6eef6;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      padding: 28px;


      background: url('img/bg.jpg') no-repeat center center fixed;
      background-size: cover;
    }

    .wrap {
      max-width: 1200px;
      margin: 0 auto;
    }

    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 18px;
    }

    header h1 {
      font-size: 18px;
      letter-spacing: 1px;
      margin: 0;
      color: var(--muted);
      font-weight: 600;
    }

    /* Grid of posters */
    .gallery {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
      gap: var(--gap);
    }

    /* Each poster card keeps the poster aspect ratio (2:3) */
    .poster {
      position: relative;
      width: 100%;
      aspect-ratio: 2 / 3;
      overflow: hidden;
      border-radius: 10px;
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.02), rgba(0, 0, 0, 0.12));
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.6), inset 0 1px 0 rgba(255, 255, 255, 0.02);
      transition: transform .28s cubic-bezier(.2, .9, .2, 1), box-shadow .28s;
      transform-origin: center;
      cursor: pointer;
      border: 1px solid rgba(255, 255, 255, 0.03);
    }

    .poster:focus {
      outline: 2px solid rgba(255, 255, 255, 0.06);
    }

    .poster img {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      transform-origin: center;
      transition: transform .4s ease;
    }

    .poster:hover,
    .poster:focus {
      transform: translateY(-6px) scale(1.03);
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.7), 0 6px 22px rgba(0, 0, 0, 0.5);
    }

    .poster:hover img {
      transform: scale(1.06) rotate(-0.3deg)
    }

    /* optional faint label shown only on focus (accessibility) */
    .label {
      position: absolute;
      left: 8px;
      right: 8px;
      bottom: 8px;
      font-size: 12px;
      color: var(--muted);
      background: linear-gradient(180deg, rgba(0, 0, 0, 0.25), rgba(0, 0, 0, 0.5));
      padding: 6px 8px;
      border-radius: 7px;
      display: none;
      /* hide by default; comment out if you want visible titles */
      pointer-events: none;
    }

    .poster:focus .label {
      display: block
    }

    /* responsive tweaks */
    @media (min-width:600px) {
      .gallery {
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      }
    }

    @media (min-width:900px) {
      .gallery {
        grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      }
    }

    @media (min-width:1200px) {
      .gallery {
        grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      }
    }

    /* Empty state */
    .empty {
      text-align: center;
      padding: 48px 12px;
      color: var(--muted);
    }

    /* small utility */
    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0
    }













    .player_filme {
      display: none;
      width: 100%;
      height: 100%;
      background-color: rgb(0, 0, 0);
      position: fixed;
      left: 0;
      top: 0;
      z-index: 1000000;
    }

    video {
      width: 100%;
      height: 100vh;
    }

    .fechar {
      cursor: pointer;
      background-color: rgb(21, 21, 21);
      padding: 5px;
      border-radius: 150%;
      position: fixed;
      right: 5%;
      top: 5%;
      color: rgb(194, 77, 77);
      font-size: x-large;
      font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif
    }

    .buscar {
      font-size: 23px;
      width: 50%;
      background-color: #414141;
      color: #ff0000;
      border: none;
    }
        </style>
    </head>
    <body>
        <!--
   <div class="player_filme" id="player_filme">
    <video id="video" controls src=""></video>
    <div class="fechar" id="fechar">
      X
    </div>
  </div>
 -->
        <div class="wrap">
            <header>
                <div aria-hidden="true" id="Perfil" style="border-radius:5px;padding:5px;color:rgb(241, 225, 225);background-color:rgb(169, 75, 75);font-size:23px">
                    Perfil
                </div>
                <input
                    class="buscar"
                    id="buscar"
                    type="text"
                    placeholder="Buscar filme..."
                >
            </header>
            <main>
                <section id="gallery" class="gallery" aria-live="polite">
                    <!-- Posters serão injetados aqui pelo JavaScript --></section>
                <div id="empty" class="empty" style="display:none">
                    Nenhuma capa disponível.
                </div>
            </main>
        </div>
        <br>
        <br>
        <!------------------------------------>
        <center>
            <button aria-hidden="true" id="Anterior" style="width: 40vw;border-radius:5px;padding:5px;color:rgb(241, 225, 225);background-color:rgb(169, 75, 75);font-size:3vw">
                <center>
                    Anterior
                </center>
            </button>
            <button aria-hidden="true" id="Proxima" style="width: 40vw;border-radius:5px;padding:5px;color:rgb(241, 225, 225);background-color:rgb(169, 75, 75);font-size:3vw">
                <center>
                    Proxima
                </center>
            </button>
        </center>
        <!------------------------------------>
        <div aria-hidden="true" id="sortearFilme" style="border-radius:5px;padding:5px;color:rgb(241, 225, 225);background-color:rgb(169, 75, 75);font-size:3vw">
            <center>
                Não sabe qual filme assistir? A gente escolhe
            </center>
        </div>
        <!------------------------------------>
        <br>
        <script src="filmes.js"></script>
        <script>
 
    if (meuPlano == 'basico') {
      get('buscar').remove()
      //remover download
    }
    //if (meuPlano == 'premium') {
    //  //remover download
    //}
    //if (meuPlano == 'master') {
    //
    //}
    //-----------------

    const gallery = document.getElementById('gallery');
    const empty = document.getElementById('empty');



    function addFilme(capa, link) {
      const a = document.createElement('a');
      a.className = 'poster';
      a.setAttribute('role', 'img');

      const img = document.createElement('img');
      img.src = 'capas/' + capa;

      a.appendChild(img);
      gallery.appendChild(a);

      var filme_link = link
      //alimenta o array com os links validos
      array_links_de_filmes_validos.push(filme_link)
      //---------------------------------
      a.addEventListener('click', () => {

        addPlayerNaPagina()
        playFilme(filme_link)
      })
    }



    function carregarTodosFilmes(list) {
      var ct = 0;
      if (!list || list.length === 0) {
        empty.style.display = 'block';
        return;
      }
      empty.style.display = 'none';

      list.forEach(() => {
        if (!posters[ct]) {
          return
        }
        if ('' == posters[ct + 1]) {
          //console.log(posters[ct])//ver filmes faltando
        }
        else {
          array_capas_de_filmes_validos.push(posters[ct])
          array_links_de_filmes_validos.push(posters[ct + 1])
        }
        ct += 2
      });
    }

    carregarTodosFilmes(posters);



    var paginaAtual = 0
    
    renderPage()

    function renderPage() {

      gallery.innerHTML = '';
      document.documentElement.scrollTop=0//rola ate o topo

      var ct = 0;
      for (let i = (itensPorPagina * paginaAtual); i < (itensPorPagina * paginaAtual + itensPorPagina); i++) {
        if (array_capas_de_filmes_validos[i]) {
          if (array_links_de_filmes_validos[i]) {
            addFilme(array_capas_de_filmes_validos[i], array_links_de_filmes_validos[i])
            ct++
          }
        }
      }

      if (ct == 0) {//nao exibiu nenhum filme
        paginaAtual--
        renderPage()
      }
    }

    addClick('Proxima', () => {
      paginaAtual++
      renderPage()
    })
    addClick('Anterior', () => {
      if (paginaAtual !== 0) {
        paginaAtual--
      }
      renderPage()
    })





    if (document.getElementById('buscar')) {
      document.getElementById('buscar').addEventListener('input', () => {


        if (document.getElementById('buscar').value == '') {
          paginaAtual = 0
          renderPage()
          return
        }


        gallery.innerHTML = '';
        document.documentElement.scrollTop=0//rola ate o topo

        for (let i = 0; i < array_capas_de_filmes_validos.length; i++) {
          if (array_capas_de_filmes_validos[i].toLowerCase().includes(document.getElementById('buscar').value.toLowerCase())) {


            addFilme(array_capas_de_filmes_validos[i], array_links_de_filmes_validos[i])

          }

        }


      })
    }








    addClick('fechar', () => {
      document.getElementById('video').src = '';
      document.getElementById('player_filme').style.display = 'none'
    })

    addClick('Perfil', () => {
      redirecionar('perfil.html')
    })


    addClick('sortearFilme', () => {
      addPlayerNaPagina()
      playFilme(sortearFilme())
    })
        </script>
    </body>
</html>
